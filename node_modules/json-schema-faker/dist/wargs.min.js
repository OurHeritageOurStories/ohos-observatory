!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).wargs=t()}(this,(function(){"use strict";const e=[],t=/$|[!-@[-`{-~][\s\S]*/g,r=Array.isArray,n=function(e){if(""===e)return"";if("false"===e)return!1;const t=Number(e);return 0*t==0?t:e},i=function(t,r,n){let i,o,s,f,l,a,u={};if(void 0!==r)for(l=0,s=r.length;l<s;l++)if(i=r[l],o=t[i],u[i]=n,void 0===o)t[i]=e;else for(a=0,f=o.length;a<f;a++)u[o[a]]=n;return u},o=function(e,t,n,i,o){let s,f,l=i[t],a=void 0===l?-1:l.length;if(a>=0||void 0===o||o(t))for(f=e[t],void 0===f?e[t]=n:r(f)?f.push(n):e[t]=[f,n],s=0;s<a;s++)e[l[s]]=e[t]};var s=function(s,f){let l,a,u,c,d,p=(f=f||{}).unknown,g=function(e){let t,n,i,o,s,f,l,a={};for(t in e)for(s=e[t],n=a[t]=r(s)?s:[s],f=0,o=n.length;f<o;f++)for(i=a[n[f]]=[t],l=0;l<o;l++)f!==l&&i.push(n[l]);return a}(f.alias),h=i(g,f.string,""),v=function(t,r){let n,i,o,s,f,l={};for(n in r)if(o=r[n],i=t[n],l[n]=o,void 0===i)t[n]=e;else for(f=0,s=i.length;f<s;f++)l[i[f]]=o;return l}(g,f.default),y=i(g,f.boolean,!1),b=f.stopEarly,m=[],x={_:m},O=0,A=0,_=s.length;for(;O<_;O++)if(a=s[O],"-"!==a[0]||"-"===a)if(b)for(;O<_;)m.push(s[O++]);else m.push(a);else if("--"===a)for(;++O<_;)m.push(s[O]);else if("-"===a[1])u=a.indexOf("=",2),"n"===a[2]&&"o"===a[3]&&"-"===a[4]?(l=a.slice(5,u>=0?u:void 0),d=!1):u>=0?(l=a.slice(2,u),d=void 0!==y[l]||(void 0===h[l]?n(a.slice(u+1)):a.slice(u+1))):(l=a.slice(2),d=void 0!==y[l]||(_===O+1||"-"===s[O+1][0]?void 0===h[l]||"":void 0===h[l]?n(s[++O]):s[++O])),o(x,l,d,g,p);else for(t.lastIndex=2,c=t.exec(a),u=c.index,d=c[0],A=1;A<u;A++)o(x,l=a[A],A+1<u?void 0===h[l]||a.substring(A+1,A=u)+d:""===d?_===O+1||"-"===s[O+1][0]?void 0===h[l]||"":void 0!==y[l]||(void 0===h[l]?n(s[++O]):s[++O]):void 0!==y[l]||(void 0===h[l]?n(d):d),g,p);for(l in v)void 0===x[l]&&(x[l]=v[l]);for(l in y)void 0===x[l]&&(x[l]=!1);for(l in h)void 0===x[l]&&(x[l]="");return x};const f=e=>`__Symbol@@${e}__`,l=f("QUOTE"),a=f("APOS"),u=f("SPA"),c=/-(\w)/g,d=/^((?!\d)[-~+./\w]+)([=:])(.+?)?$/,p=/(["'])(?:(?!\1).)*\1/,g=['"',"'"," "],h=[/\\"/g,/\\'/g,/\\ /g],v=[l,a,u],y=[l,a,u].map(e=>new RegExp(e,"g"));function b(e){return y.reduce((e,t,r)=>e.replace(t,g[r]),e)}function m(e,t){for(;p.test(e);){const t=e.match(p),r=t[0].substr(1,t[0].length-2);e=e.replace(t[0],g.reduce((e,t,r)=>e.replace(t,v[r]),r))}if(t)for(;e.indexOf(" ")>-1;)e=g.reduce((e,t,r)=>e.replace(t,v[r]),e);return e.split(/\s+/)}function x(e,t){return"function"==typeof t?t(e):e}function O(e){return e.replace(c,(e,t)=>t.toUpperCase())}function A(e,t){if("string"==typeof e){if((t||0===e.indexOf("--"))&&-1===e.indexOf("no-")){if(-1===e.indexOf("="))return t?O(e):`--${O(e.substr(2))}`;let[r,...n]=e.split("=");return r=t?O(r):`--${O(r.substr(2))}`,n=n.length>1?n.join("="):n[0],`${r}=${n}`}return e}return e.map(e=>A(e,t))}return(e,t,r)=>{if("function"==typeof(t=t||{})&&(r=t,t={}),t.format&&(r=t.format,delete t.format),!Array.isArray(e)){let t;e=function(e){return h.reduce((e,t,r)=>e.replace(t,v[r]),e)}(String(e||""));do{t=e.match(p),t&&(e=e.replace(t[0],m(t[0],!0)))}while(t);e=e.trim().split(/\s+/).map(b).filter(e=>e)}const n=e.indexOf("--"),i=[];n>-1&&(e.slice(n+1).forEach(e=>{i.push(x(e,r))}),e.splice(n+1,e.length)),"string"==typeof t.boolean&&(t.boolean=t.boolean.split("")),"string"==typeof t.string&&(t.string=t.string.split("")),t.boolean&&(t.boolean=A(t.boolean,!0)),t.string&&(t.string=A(t.string,!0)),t.alias&&Object.keys(t.alias).forEach(e=>{t.alias[e]=A(t.alias[e],!0)});const o=s(A(e),t),f=o._.slice();Object.keys(o).forEach(e=>{""===e&&delete o[e],""===o[e]&&(o[e]=null)});const l={},a={};return delete o._,Object.keys(o).forEach(e=>{const n=o[e];-1!==e.indexOf("-")&&(delete o[e],e=O(e)),t.alias&&t.alias[e]&&0===t.alias[e].indexOf("no-")&&(o[t.alias[e]]&&(o[t.alias[e].substr(3)]=!1),o[e]=!0),Array.isArray(n)&&(o[e]=n.map(e=>x(e,r))),"string"==typeof n&&("="===n.charAt()?o[e]=x(n.substr(1),r):o[e]=x(n,r))}),{_:f.reduce((e,t)=>{const n=t.match(d);return n?"="===n[2]?l[n[1]]=x(n[3]||"",r):a[n[1]]?(Array.isArray(a[n[1]])||(a[n[1]]=[a[n[1]]]),a[n[1]].push(x(n[3]||"",r))):a[n[1]]=x(n[3]||"",r):e.push(x(t,r)),e},[]),raw:i,data:l,flags:o,params:a}}}));
