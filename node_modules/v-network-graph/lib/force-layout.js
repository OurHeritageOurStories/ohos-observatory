var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,n,e)=>n in t?__defProp(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,__spreadValues=(t,n)=>{for(var e in n||(n={}))__hasOwnProp.call(n,e)&&__defNormalProp(t,e,n[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(n))__propIsEnum.call(n,e)&&__defNormalProp(t,e,n[e]);return t},__spreadProps=(t,n)=>__defProps(t,__getOwnPropDescs(n));!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self)["v-network-graph"]={},t.Vue)}(this,(function(t,n){"use strict";function e(t,n){var e,r=1;function o(){var o,i,a=e.length,u=0,f=0;for(o=0;o<a;++o)u+=(i=e[o]).x,f+=i.y;for(u=(u/a-t)*r,f=(f/a-n)*r,o=0;o<a;++o)(i=e[o]).x-=u,i.y-=f}return null==t&&(t=0),null==n&&(n=0),o.initialize=function(t){e=t},o.x=function(n){return arguments.length?(t=+n,o):t},o.y=function(t){return arguments.length?(n=+t,o):n},o.strength=function(t){return arguments.length?(r=+t,o):r},o}function r(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var o,i,a,u,f,l,s,c,h,y=t._root,d={data:r},v=t._x0,x=t._y0,p=t._x1,_=t._y1;if(!y)return t._root=d,t;for(;y.length;)if((l=n>=(i=(v+p)/2))?v=i:p=i,(s=e>=(a=(x+_)/2))?x=a:_=a,o=y,!(y=y[c=s<<1|l]))return o[c]=d,t;if(u=+t._x.call(null,y.data),f=+t._y.call(null,y.data),n===u&&e===f)return d.next=y,o?o[c]=d:t._root=d,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(l=n>=(i=(v+p)/2))?v=i:p=i,(s=e>=(a=(x+_)/2))?x=a:_=a}while((c=s<<1|l)==(h=(f>=a)<<1|u>=i));return o[h]=y,o[c]=d,t}function o(t,n,e,r,o){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=o}function i(t){return t[0]}function a(t){return t[1]}function u(t,n,e){var r=new f(null==n?i:n,null==e?a:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function f(t,n,e,r,o,i){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function l(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var s=u.prototype=f.prototype;function c(t){return function(){return t}}function h(t){return 1e-6*(t()-.5)}function y(t){return t.x+t.vx}function d(t){return t.y+t.vy}function v(t){var n,e,r,o=1,i=1;function a(){for(var t,a,l,s,c,v,x,p=n.length,_=0;_<i;++_)for(a=u(n,y,d).visitAfter(f),t=0;t<p;++t)l=n[t],v=e[l.index],x=v*v,s=l.x+l.vx,c=l.y+l.vy,a.visit(g);function g(t,n,e,i,a){var u=t.data,f=t.r,y=v+f;if(!u)return n>s+y||i<s-y||e>c+y||a<c-y;if(u.index>l.index){var d=s-u.x-u.vx,p=c-u.y-u.vy,_=d*d+p*p;_<y*y&&(0===d&&(_+=(d=h(r))*d),0===p&&(_+=(p=h(r))*p),_=(y-(_=Math.sqrt(_)))/_*o,l.vx+=(d*=_)*(y=(f*=f)/(x+f)),l.vy+=(p*=_)*y,u.vx-=d*(y=1-y),u.vy-=p*y)}}}function f(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function l(){if(n){var r,o,i=n.length;for(e=new Array(i),r=0;r<i;++r)o=n[r],e[o.index]=+t(o,r,n)}}return"function"!=typeof t&&(t=c(null==t?1:+t)),a.initialize=function(t,e){n=t,r=e,l()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:c(+n),l(),a):t},a}function x(t){return t.index}function p(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function _(t){var n,e,r,o,i,a,u=x,f=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},l=c(30),s=1;function y(r){for(var o=0,u=t.length;o<s;++o)for(var f,l,c,y,d,v,x,p=0;p<u;++p)l=(f=t[p]).source,y=(c=f.target).x+c.vx-l.x-l.vx||h(a),d=c.y+c.vy-l.y-l.vy||h(a),y*=v=((v=Math.sqrt(y*y+d*d))-e[p])/v*r*n[p],d*=v,c.vx-=y*(x=i[p]),c.vy-=d*x,l.vx+=y*(x=1-x),l.vy+=d*x}function d(){if(r){var a,f,l=r.length,s=t.length,c=new Map(r.map(((t,n)=>[u(t,n,r),t])));for(a=0,o=new Array(l);a<s;++a)(f=t[a]).index=a,"object"!=typeof f.source&&(f.source=p(c,f.source)),"object"!=typeof f.target&&(f.target=p(c,f.target)),o[f.source.index]=(o[f.source.index]||0)+1,o[f.target.index]=(o[f.target.index]||0)+1;for(a=0,i=new Array(s);a<s;++a)f=t[a],i[a]=o[f.source.index]/(o[f.source.index]+o[f.target.index]);n=new Array(s),v(),e=new Array(s),_()}}function v(){if(r)for(var e=0,o=t.length;e<o;++e)n[e]=+f(t[e],e,t)}function _(){if(r)for(var n=0,o=t.length;n<o;++n)e[n]=+l(t[n],n,t)}return null==t&&(t=[]),y.initialize=function(t,n){r=t,a=n,d()},y.links=function(n){return arguments.length?(t=n,d(),y):t},y.id=function(t){return arguments.length?(u=t,y):u},y.iterations=function(t){return arguments.length?(s=+t,y):s},y.strength=function(t){return arguments.length?(f="function"==typeof t?t:c(+t),v(),y):f},y.distance=function(t){return arguments.length?(l="function"==typeof t?t:c(+t),_(),y):l},y}s.copy=function(){var t,n,e=new f(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=l(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var o=0;o<4;++o)(n=r.source[o])&&(n.length?t.push({source:n,target:r.target[o]=new Array(4)}):r.target[o]=l(n));return e},s.add=function(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return r(this.cover(n,e),n,e,t)},s.addAll=function(t){var n,e,o,i,a=t.length,u=new Array(a),f=new Array(a),l=1/0,s=1/0,c=-1/0,h=-1/0;for(e=0;e<a;++e)isNaN(o=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(u[e]=o,f[e]=i,o<l&&(l=o),o>c&&(c=o),i<s&&(s=i),i>h&&(h=i));if(l>c||s>h)return this;for(this.cover(l,s).cover(c,h),e=0;e<a;++e)r(this,u[e],f[e],t[e]);return this},s.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,o=this._x1,i=this._y1;if(isNaN(e))o=(e=Math.floor(t))+1,i=(r=Math.floor(n))+1;else{for(var a,u,f=o-e||1,l=this._root;e>t||t>=o||r>n||n>=i;)switch(u=(n<r)<<1|t<e,(a=new Array(4))[u]=l,l=a,f*=2,u){case 0:o=e+f,i=r+f;break;case 1:e=o-f,i=r+f;break;case 2:o=e+f,r=i-f;break;case 3:e=o-f,r=i-f}this._root&&this._root.length&&(this._root=l)}return this._x0=e,this._y0=r,this._x1=o,this._y1=i,this},s.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},s.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},s.find=function(t,n,e){var r,i,a,u,f,l,s,c=this._x0,h=this._y0,y=this._x1,d=this._y1,v=[],x=this._root;for(x&&v.push(new o(x,c,h,y,d)),null==e?e=1/0:(c=t-e,h=n-e,y=t+e,d=n+e,e*=e);l=v.pop();)if(!(!(x=l.node)||(i=l.x0)>y||(a=l.y0)>d||(u=l.x1)<c||(f=l.y1)<h))if(x.length){var p=(i+u)/2,_=(a+f)/2;v.push(new o(x[3],p,_,u,f),new o(x[2],i,_,p,f),new o(x[1],p,a,u,_),new o(x[0],i,a,p,_)),(s=(n>=_)<<1|t>=p)&&(l=v[v.length-1],v[v.length-1]=v[v.length-1-s],v[v.length-1-s]=l)}else{var g=t-+this._x.call(null,x.data),w=n-+this._y.call(null,x.data),m=g*g+w*w;if(m<e){var N=Math.sqrt(e=m);c=t-N,h=n-N,y=t+N,d=n+N,r=x.data}}return r},s.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,o,i,a,u,f,l,s,c,h,y=this._root,d=this._x0,v=this._y0,x=this._x1,p=this._y1;if(!y)return this;if(y.length)for(;;){if((l=i>=(u=(d+x)/2))?d=u:x=u,(s=a>=(f=(v+p)/2))?v=f:p=f,n=y,!(y=y[c=s<<1|l]))return this;if(!y.length)break;(n[c+1&3]||n[c+2&3]||n[c+3&3])&&(e=n,h=c)}for(;y.data!==t;)if(r=y,!(y=y.next))return this;return(o=y.next)&&delete y.next,r?(o?r.next=o:delete r.next,this):n?(o?n[c]=o:delete n[c],(y=n[0]||n[1]||n[2]||n[3])&&y===(n[3]||n[2]||n[1]||n[0])&&!y.length&&(e?e[h]=y:this._root=y),this):(this._root=o,this)},s.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},s.root=function(){return this._root},s.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},s.visit=function(t){var n,e,r,i,a,u,f=[],l=this._root;for(l&&f.push(new o(l,this._x0,this._y0,this._x1,this._y1));n=f.pop();)if(!t(l=n.node,r=n.x0,i=n.y0,a=n.x1,u=n.y1)&&l.length){var s=(r+a)/2,c=(i+u)/2;(e=l[3])&&f.push(new o(e,s,c,a,u)),(e=l[2])&&f.push(new o(e,r,c,s,u)),(e=l[1])&&f.push(new o(e,s,i,a,c)),(e=l[0])&&f.push(new o(e,r,i,s,c))}return this},s.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new o(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,u=n.x0,f=n.y0,l=n.x1,s=n.y1,c=(u+l)/2,h=(f+s)/2;(a=i[0])&&e.push(new o(a,u,f,c,h)),(a=i[1])&&e.push(new o(a,c,f,l,h)),(a=i[2])&&e.push(new o(a,u,h,c,s)),(a=i[3])&&e.push(new o(a,c,h,l,s))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},s.x=function(t){return arguments.length?(this._x=t,this):this._x},s.y=function(t){return arguments.length?(this._y=t,this):this._y};var g={value:()=>{}};function w(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new m(r)}function m(t){this._=t}function N(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function b(t,n){for(var e,r=0,o=t.length;r<o;++r)if((e=t[r]).name===n)return e.value}function M(t,n,e){for(var r=0,o=t.length;r<o;++r)if(t[r].name===n){t[r]=g,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}m.prototype=w.prototype={constructor:m,on:function(t,n){var e,r=this._,o=N(t+"",r),i=-1,a=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++i<a;)if(e=(t=o[i]).type)r[e]=M(r[e],t.name,n);else if(null==n)for(e in r)r[e]=M(r[e],t.name,null);return this}for(;++i<a;)if((e=(t=o[i]).type)&&(e=b(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new m(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,o=new Array(e),i=0;i<e;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,e=(r=this._[t]).length;i<e;++i)r[i].value.apply(n,o)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(n,e)}};var A,O,P=0,k=0,j=0,L=0,E=0,q=0,S="object"==typeof performance&&performance.now?performance:Date,z="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function D(){return E||(z(T),E=S.now()+q)}function T(){E=0}function I(){this._call=this._time=this._next=null}function V(t,n,e){var r=new I;return r.restart(t,n,e),r}function F(){E=(L=S.now())+q,P=k=0;try{!function(){D(),++P;for(var t,n=A;n;)(t=E-n._time)>=0&&n._call.call(void 0,t),n=n._next;--P}()}finally{P=0,function(){var t,n,e=A,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:A=n);O=t,C(r)}(),E=0}}function B(){var t=S.now(),n=t-L;n>1e3&&(q-=n,L=t)}function C(t){P||(k&&(k=clearTimeout(k)),t-E>24?(t<1/0&&(k=setTimeout(F,t-S.now()-q)),j&&(j=clearInterval(j))):(j||(L=S.now(),j=setInterval(B,1e3)),P=1,z(F)))}I.prototype=V.prototype={constructor:I,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?D():+e)+(null==n?0:+n),this._next||O===this||(O?O._next=this:A=this,O=this),this._call=t,this._time=e,C()},stop:function(){this._call&&(this._call=null,this._time=1/0,C())}};const K=4294967296;function R(t){return t.x}function $(t){return t.y}var W=Math.PI*(3-Math.sqrt(5));function X(t){var n,e=1,r=.001,o=1-Math.pow(r,1/300),i=0,a=.6,u=new Map,f=V(c),l=w("tick","end"),s=function(){let t=1;return()=>(t=(1664525*t+1013904223)%K)/K}();function c(){h(),l.call("tick",n),e<r&&(f.stop(),l.call("end",n))}function h(r){var f,l,s=t.length;void 0===r&&(r=1);for(var c=0;c<r;++c)for(e+=(i-e)*o,u.forEach((function(t){t(e)})),f=0;f<s;++f)null==(l=t[f]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return n}function y(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var o=10*Math.sqrt(.5+e),i=e*W;n.x=o*Math.cos(i),n.y=o*Math.sin(i)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function d(n){return n.initialize&&n.initialize(t,s),n}return null==t&&(t=[]),y(),n={tick:h,restart:function(){return f.restart(c),n},stop:function(){return f.stop(),n},nodes:function(e){return arguments.length?(t=e,y(),u.forEach(d),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(o=+t,n):+o},alphaTarget:function(t){return arguments.length?(i=+t,n):i},velocityDecay:function(t){return arguments.length?(a=1-t,n):1-a},randomSource:function(t){return arguments.length?(s=t,u.forEach(d),n):s},force:function(t,e){return arguments.length>1?(null==e?u.delete(t):u.set(t,d(e)),n):u.get(t)},find:function(n,e,r){var o,i,a,u,f,l=0,s=t.length;for(null==r?r=1/0:r*=r,l=0;l<s;++l)(a=(o=n-(u=t[l]).x)*o+(i=e-u.y)*i)<r&&(f=u,r=a);return f},on:function(t,e){return arguments.length>1?(l.on(t,e),n):l.on(t)}}}function Y(){var t,n,e,r,o,i=c(-30),a=1,f=1/0,l=.81;function s(e){var o,i=t.length,a=u(t,R,$).visitAfter(d);for(r=e,o=0;o<i;++o)n=t[o],a.visit(v)}function y(){if(t){var n,e,r=t.length;for(o=new Array(r),n=0;n<r;++n)e=t[n],o[e.index]=+i(e,n,t)}}function d(t){var n,e,r,i,a,u=0,f=0;if(t.length){for(r=i=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(u+=n.value,f+=e,r+=e*n.x,i+=e*n.y);t.x=r/f,t.y=i/f}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=o[n.data.index]}while(n=n.next)}t.value=u}function v(t,i,u,s){if(!t.value)return!0;var c=t.x-n.x,y=t.y-n.y,d=s-i,v=c*c+y*y;if(d*d/l<v)return v<f&&(0===c&&(v+=(c=h(e))*c),0===y&&(v+=(y=h(e))*y),v<a&&(v=Math.sqrt(a*v)),n.vx+=c*t.value*r/v,n.vy+=y*t.value*r/v),!0;if(!(t.length||v>=f)){(t.data!==n||t.next)&&(0===c&&(v+=(c=h(e))*c),0===y&&(v+=(y=h(e))*y),v<a&&(v=Math.sqrt(a*v)));do{t.data!==n&&(d=o[t.data.index]*r/v,n.vx+=c*d,n.vy+=y*d)}while(t=t.next)}}return s.initialize=function(n,r){t=n,e=r,y()},s.strength=function(t){return arguments.length?(i="function"==typeof t?t:c(+t),y(),s):i},s.distanceMin=function(t){return arguments.length?(a=t*t,s):Math.sqrt(a)},s.distanceMax=function(t){return arguments.length?(f=t*t,s):Math.sqrt(f)},s.theta=function(t){return arguments.length?(l=t*t,s):Math.sqrt(l)},s}var Z=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",forceCenter:e,forceCollide:v,forceLink:_,forceManyBody:Y,forceRadial:function(t,n,e){var r,o,i,a=c(.1);function u(t){for(var a=0,u=r.length;a<u;++a){var f=r[a],l=f.x-n||1e-6,s=f.y-e||1e-6,c=Math.sqrt(l*l+s*s),h=(i[a]-c)*o[a]*t/c;f.vx+=l*h,f.vy+=s*h}}function f(){if(r){var n,e=r.length;for(o=new Array(e),i=new Array(e),n=0;n<e;++n)i[n]=+t(r[n],n,r),o[n]=isNaN(i[n])?0:+a(r[n],n,r)}}return"function"!=typeof t&&(t=c(+t)),null==n&&(n=0),null==e&&(e=0),u.initialize=function(t){r=t,f()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:c(+t),f(),u):a},u.radius=function(n){return arguments.length?(t="function"==typeof n?n:c(+n),f(),u):t},u.x=function(t){return arguments.length?(n=+t,u):n},u.y=function(t){return arguments.length?(e=+t,u):e},u},forceSimulation:X,forceX:function(t){var n,e,r,o=c(.1);function i(t){for(var o,i=0,a=n.length;i<a;++i)(o=n[i]).vx+=(r[i]-o.x)*e[i]*t}function a(){if(n){var i,a=n.length;for(e=new Array(a),r=new Array(a),i=0;i<a;++i)e[i]=isNaN(r[i]=+t(n[i],i,n))?0:+o(n[i],i,n)}}return"function"!=typeof t&&(t=c(null==t?0:+t)),i.initialize=function(t){n=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:c(+t),a(),i):o},i.x=function(n){return arguments.length?(t="function"==typeof n?n:c(+n),a(),i):t},i},forceY:function(t){var n,e,r,o=c(.1);function i(t){for(var o,i=0,a=n.length;i<a;++i)(o=n[i]).vy+=(r[i]-o.y)*e[i]*t}function a(){if(n){var i,a=n.length;for(e=new Array(a),r=new Array(a),i=0;i<a;++i)e[i]=isNaN(r[i]=+t(n[i],i,n))?0:+o(n[i],i,n)}}return"function"!=typeof t&&(t=c(null==t?0:+t)),i.initialize=function(t){n=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:c(+t),a(),i):o},i.y=function(n){return arguments.length?(t="function"==typeof n?n:c(+n),a(),i):t},i}});t.ForceLayout=class{constructor(t={}){this.options=t}activate(t){const{layouts:e,nodes:r,edges:o,emitter:i,svgPanZoom:a}=t;let{nodeLayouts:u,nodeLayoutMap:f}=this.buildNodeLayouts(r.value,e,{x:0,y:0});const l=this.createSimulation(u,this.forceLayoutEdges(o.value));l.on("tick",(()=>{var t,n;for(const r of u){const o=null==e?void 0:e[r.id];o&&(o.x=null!=(t=r.x)?t:0,o.y=null!=(n=r.y)?n:0)}}));const s=()=>{l.alpha(.1).restart()},c=t=>{for(const[n,e]of Object.entries(t)){const t=f[n];t.fx=e.x,t.fy=e.y}s()},h=t=>{var n;for(const[r,o]of Object.entries(t)){const t=this.getNodeLayout(e,r),i=null!=(n=null==f?void 0:f[r])?n:{x:0,y:0};t.value.fixed||this.options.positionFixedByDrag?(i.fx=o.x,i.fy=o.y,t.value.fixed=!0):(i.x=o.x,i.y=o.y,delete i.fx,delete i.fy)}s()},y=({node:t,event:n})=>{if(this.options.positionFixedByClickWithAltKey&&n.altKey){const n=this.getNodeLayout(e,t);let r=null==f?void 0:f[t];r||(r={id:t,x:0,y:0},f[t]=r),n.value.fixed?(delete n.value.fixed,r.x=r.fx||r.x,r.y=r.fy||r.y,delete r.fx,delete r.fy):(n.value.fixed=!0,r.fx=r.x,r.fy=r.y),s()}},d=n.watch((()=>[Object.keys(r.value),Object.values(o.value).map((t=>`${t.source}=${t.target}`))]),(()=>{const t=a.getViewArea();({nodeLayouts:u,nodeLayoutMap:f}=this.buildNodeLayouts(r.value,e,t.center)),l.nodes(u);const n=l.force("edge");n&&n.links(this.forceLayoutEdges(o.value)),s()}));i.on("node:dragstart",c),i.on("node:pointermove",c),i.on("node:dragend",h),i.on("node:click",y),this.onDeactivate=()=>{l.stop(),d(),i.off("node:dragstart",c),i.off("node:pointermove",c),i.off("node:dragend",h),i.off("node:click",y)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(t,n){if(this.options.createSimulation)return this.options.createSimulation(Z,t,n);{const r=_(n).id((t=>t.id));return X(t).force("edge",r.distance(100)).force("charge",Y()).force("collide",v(50).strength(.2)).force("center",e().strength(.05)).alphaMin(.001)}}buildNodeLayouts(t,n,e){const r=Object.keys(t).filter((t=>!(t in n)));for(const a of r)n[a]=__spreadValues({},e);const o=this.forceNodeLayouts(n),i=Object.fromEntries(o.map((t=>[t.id,t])));return{nodeLayouts:o,nodeLayoutMap:i}}forceNodeLayouts(t){return Object.entries(t).map((([t,n])=>n.fixed?__spreadProps(__spreadValues({id:t},n),{fx:n.x,fy:n.y}):__spreadValues({id:t},n)))}forceLayoutEdges(t){return Object.values(t).map((t=>({source:t.source,target:t.target})))}getNodeLayout(t,e){const r=n.toRef(t,e);return r.value||(r.value={x:0,y:0}),r}},Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module"}));
//# sourceMappingURL=force-layout.js.map
